---
title: "R Notebook"
author: Nicholas Fraser
output: github_document
---

```{r echo = F, include = F}
# Load necessary libraries
library(tidyverse)
```

# Open Access and Altmetrics

This notebook contains documentation for the study on the relationship between Open Access (OA) and altmetrics.

## Article Corpus

Articles were derived from the in-house Web of Science (WOS) database maintained by CWTS.

The following tables were used:

- wosdb.dbo.UT (source item)
- wosdb.dbo.UI (source issue)
- wosdb.dbo.AR (additional item identifier)

Articles were limited to those published in publication years 2012-2018, articles published in journals, 'Article' and 'Review' document types, and articles with valid (non-null) DOIs. DOIs were converted to lowercase for matching with other datasets (e.g. Unpaywall, Altmetric.com).

A table containing relevant items was extracted with the SQL query
[create_table_wos_items.sql](queries/create_table_wos_items.sql).

##### Distribution of WOS items by year

```{r message = F}

read_csv("data/wos_items_year.csv") %>%
  ggplot() +
  geom_bar(aes(x = year, y = n_items), stat = "identity") +
  theme_minimal() +
  labs(x = "", 
       y = "Published articles") +
  scale_x_continuous(breaks = 2012:2018) +
  scale_y_continuous(labels = scales::comma)
  
```

## OA Classification

OA classification was conducted using data from Unpaywall. Unpaywall data (from the April 2019 data dump) has been parsed into a relational (SQL) database at CWTS. 

The following tables were used:

- unpaywall_2019apr_json.dbo.pub (article details)
- unpaywall_2019apr_json.dbo.pub_oa_location (article oa location details)

OA classification was initially conducted following the workflow detailed in Figure 1 from [Robinson-Garcia et al. (2019)](https://arxiv.org/abs/1906.03840):

![robinson_garcia_unpaywall_classification](figures/external/robinson_garcia_unpaywall_classification.PNG)

This classification diverges from the OA classification scheme [used by Unpaywall directly](https://support.unpaywall.org/support/solutions/articles/44001777288-what-do-the-types-of-oa-status-green-gold-hybrid-and-bronze-mean-) in two ways:

* Green OA is a non-exclusive category, meaning that it can overlap with other journal-based OA categories. E.g. a paper can be published in a Gold OA journal, and hosted on a Green OA repository, and would thus be labelled both 'Gold' and 'Green'.
* Articles hosted on PubMed Central (PMC) are, however, not classified as Green OA *if* they are available through another OA outlet. As authors do not submit manuscripts to PMC directly, it is not a 'self-archiving' repository in the 'traditional' sense, and may coincide largely with Gold OA journals (e.g. all articles in PLOS journals are also available in PMC).

Some implications of these two points are considered below.

### PMC

To test the influence of the inclusion/exclusion of articles contained in PMC on Green OA rates, two classification procedures were conducted: one including all PMC articles in Green OA ([create_table_unpaywall_classification_nopmccor.sql](queries/create_table_unpaywall_classification_nopmccor.sql)), and one excluding PMC articles from Green OA when they match with an alternative kind of OA ([create_table_unpaywall_classification_pmccor.sql](queries/create_table_unpaywall_classification_pmccor.sql)).




### Green OA



## Altmetrics

### Platforms

### Indicators




