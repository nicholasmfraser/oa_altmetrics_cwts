---
title: "R Notebook"
author: Nicholas Fraser
output: github_document
---

```{r echo = F, include = F, message = F, warning = F}
# Load necessary libraries
library(tidyverse)

# Set chart themes
theme_set(theme_light() +
          theme(text = element_text(size=12),
                axis.text.x = element_text(angle=45, hjust=1),
                axis.title.x = element_text(margin = margin(t = 15, unit = "pt")),
                axis.title.y = element_text(margin = margin(r = 15, unit = "pt")),
                plot.title = element_text(margin = margin(t = 5, b = 15, unit = "pt"),
                                          hjust = 0.5),
                panel.spacing = unit(1, "lines"),
                strip.background = element_blank(),
                strip.text = element_text(colour = "grey10")))

# Color palette
# From https://www.materialui.co/colors
palette <- c(
  `closed`      = "#9E9E9E",
  `open`        = "#00BCD4",
  `gold`        = "#FDD835",
  `hybrid`      = "#FB8C00",
  `bronze`      = "#BF360C",
  `green`       = "#4CAF50",
  `light green` = "#A5D6A7",
  `dark green`  = "#2E7D32")

palette_color <- function(color) {
  cols <- c(color)
  if (is.null(cols)) {
    return(NA)
  } else {
    return(unname(palette[color]))
  }
}
```

# Open Access and Altmetrics

This notebook contains documentation for the study on the relationship between Open Access (OA) and altmetrics.

## Web of Science

### Article Corpus

Articles were derived from the in-house Web of Science (WOS) database maintained by CWTS ([query](queries/create_table_wos_items.sql)).

The following tables were used to build the article corpus:

- woskb.dbo.cwts_ut
- woskb.dbo.cwts_pub_details

Extracted fields included:

- ut
- doi (limited to non-null values)
- year (limited to 2012:2018)
- n_authors
- n_institutes
- n_countries
- source (journal name)
- doc type (limited to 'Article' and 'Review')

DOIs were converted to lowercase for matching with other datasets (e.g. Unpaywall, Altmetric.com). A small number of DOIs (N ~ 250) were found to include a comma in the DOI string (causing issues with .csv export) and were thus removed.

##### Distribution of WOS articles per year ([query](queries/calc_wos_items_year.sql))

```{r echo = F, message = F, warning = F}

read_csv("data/wos_items_year.csv") %>%
  ggplot() +
  geom_bar(aes(x = year, y = n_items), stat = "identity") +
  labs(x = "", 
       y = "Articles") +
  scale_x_continuous(breaks = 2012:2018) +
  scale_y_continuous(labels = scales::comma)

```

### Author Countries

ISO Alpha-2 country codes of **first** authors were extracted for the set of articles defined above ([query](queries/create_table_wos_first_author_countries.sql)), combining the following tables:

- userdb_frasernm.dbo.wos_items (as defined above)
- wosaddr1913.dbo.pub_author_affiliation
- wosaddr1913.dbo.pub_affiliation
- wosaddr1913.dbo.country

Where authors were affiliated with more than one country, country affiliations were weighted accordingly (e.g. an author belonging to the UK and US would count as 0.5 towards the UK, and 0.5 towards the US).

##### Top 30 countries included in WOS article corpus ([query](queries/calc_wos_items_country.sql))

```{r echo = F, message = F, warning = F}

read_csv("data/wos_items_country.csv") %>%
  mutate(country = countrycode::countrycode(country, "iso2c", "country.name"),
         proportion = n_items / sum(n_items)) %>%
  arrange(proportion) %>%
  top_n(30) %>%
  ggplot(aes(x = reorder(country, proportion), y = proportion)) +
  geom_bar(stat = "identity") + 
  labs(x = "",
       y= "Articles") +
  scale_y_continuous(labels = scales::percent) +
  coord_flip() +
  theme(text = element_text(size = 10))

```

### Subject Classifications

Subject classifications are assigned to 5 major subject areas, which conform to the subject classifications used in the [Leiden Ranking](https://leidenranking.com). The fields are defined algorithmically (as outlined [here](https://leidenranking.com/information/fields)), based on the publication-level classification system detailed in [Waltman and van Eck (2012)](https://onlinelibrary.wiley.com/doi/full/10.1002/asi.22748). In brief terms, publications are initially clustered into research areas at 3 levels of granularity, based on citation relations. The classification system here uses the level of highest granularity, where publications are clustered into 4535 micro-level fields of science. For each micro-level field, the overlap with each of the 252 WOS subject areas (excluding Multidisciplinary Sciences) is determined. Each of these 252 subject categories is then assigned to the 5 main fields of the Leiden Ranking.

For this study, classification was conducted using the following tables ([query](queries/create_table_wos_classification.sql)):

- userdb_frasernm.dbo.wos_items (as defined above)
- wosclassification1913.dbo.clustering
- wosclassification1913.dbo.cluster_LR_main_field3
- wosclassification1913.dbo.LR_main_field

Note that publications can belong to more than one field, which are then weighted accordingly (i.e. a publication belonging to both "Biomedical and Health Sciences" and "Life and Earth Sciences" would be assigned a weight of 0.5 for both fields).

##### Proportion of WOS articles contained in each subject classification ([query](queries/calc_wos_items_classification.sql))

```{r echo = F, message = F, warning = F}

read_csv("data/wos_items_classification.csv") %>%
  mutate(proportion = n_items / sum(n_items)) %>%
  arrange(proportion) %>%
  ggplot(aes(x = reorder(LR_main_field, proportion), y = proportion)) +
  geom_bar(stat = "identity") + 
  labs(x = "",
       y= "Articles") +
  scale_y_continuous(labels = scales::percent) +
  coord_flip() +
  theme(text = element_text(size = 10))


```

## Altmetrics Data

Altmetrics data were derived from the CWTS in-house database of Altmetric.com (version October 2019) ([query](queries/create_table_altmetric_counts.sql)), using the following tables:

- userdb_frasernm.dbo.wos_items (as defined above)
- altmetric_2019oct.dbo.pub_citation
- altmetric_2019oct.dbo.pub_counts

Counts were initially extracted for the following altmetric indicators:

- Blogs
- Facebook
- News
- Policy
- Twitter
- Wikipedia

Where no altmetric information was found for an article, counts were registered as zero.

## OA Classification

OA classification was conducted using data from Unpaywall. Unpaywall data (from the April 2019 data dump) has been parsed into a relational (SQL) database at CWTS. 

The following tables were used:

- unpaywall_2019apr_json.dbo.pub (article details)
- unpaywall_2019apr_json.dbo.pub_oa_location (article oa location details)

Articles were limited to those with a publication date between 2010 and 2019. This is slightly more inclusive than the WOS articles (2012-2019), to account for potential differences in recorded publication years between the two datasets (and thus ensures maximum coverage of WoS articles in the Unpaywall dataset).

OA classification was first conducted following the workflow detailed in Figure 1 from [Robinson-Garcia et al. (2019)](https://arxiv.org/abs/1906.03840):

![robinson_garcia_unpaywall_classification](figures/external/robinson_garcia_unpaywall_classification.PNG)

This classification diverges from the OA classification scheme [used by Unpaywall directly](https://support.unpaywall.org/support/solutions/articles/44001777288-what-do-the-types-of-oa-status-green-gold-hybrid-and-bronze-mean-) in two ways:

* Green OA is a non-exclusive category, meaning that it can overlap with other journal-based OA categories. E.g. a paper can be published in a Gold OA journal, and hosted on a Green OA repository, and would thus be labelled both 'Gold' and 'Green'.
* Articles hosted on PubMed Central (PMC) are, however, not classified as Green OA *if* they are available through another OA outlet. As authors do not submit manuscripts to PMC directly, it is not a 'self-archiving' repository in the 'traditional' sense.

Some implications of these two points are considered below.

### PMC

To test the influence of the inclusion/exclusion of articles contained in PMC on Green OA rates, two classification procedures were conducted: one including all PMC articles in Green OA ([create_table_unpaywall_classification_nopmccor.sql](queries/create_table_unpaywall_classification_nopmccor.sql)), and one excluding PMC articles from Green OA when they match with an alternative kind of OA ([create_table_unpaywall_classification_pmccor.sql](queries/create_table_unpaywall_classification_pmccor.sql)).

##### Green OA articles in Unpaywall including and excluding PMC ([query](queries/calc_unpaywall_classification_pmc_comparison.sql))

```{r echo = F, message = F, warning = F}

read_csv("data/unpaywall_classification_pmc_comparison.csv",
         col_types = "nln") %>%
  mutate(pmc_corrected = factor(pmc_corrected,
                                levels = c(T, F))) %>%
  ggplot(aes(x = year, y = green, fill = pmc_corrected)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "", 
       y = "Green OA articles",
       fill = "Excludes PMC") +
  scale_x_continuous(breaks = 2010:2019) +
  scale_y_continuous(labels = scales::comma) +
  scale_fill_manual(values = c(palette_color("dark green"),
                               palette_color("light green")))
```

PMC clearly contributes a large proportion of Green OA from 2010 to 2017. In 2018 and 2019, no PMC articles are found to contribute to Green OA  - notably, no articles are found for these year in the Unpaywall data where the evidence is described as "oa repository (via pmcid lookup)". However, when checking the same articles from 2018 and 2019 directly via the Unpaywall API, PMC *is* included as an evidence source. A possibility is that Unpaywall only crawl PMC sporadically (as articles in Gold OA journals, such as PLOS ONE, are deposited immediately to PMC), or that a technical issue occurred [**to do:** investigate this issue further. Contact Unpaywall?]

##### Overlap of articles in PMC with journal-based OA types ([query](queries/calc_unpaywall_classification_pmc_overlap.sql))

```{r echo = F, message = F, warning = F}

read_csv("data/unpaywall_classification_pmc_overlap.csv") %>%
  pivot_longer(closed:bronze) %>%
  # there is no overlap between closed and PMC
  filter(name != "closed") %>%
  mutate(type = factor(name,
                       levels = c("gold", "hybrid", "bronze"))) %>%
  ggplot() +
  geom_bar(aes(x = year, y = value, fill = type),
           stat = "identity", position = "dodge", width = 0.75) +
  labs(x = "", 
       y = "Articles",
       fill = "OA Type") +
  scale_x_continuous(breaks = 2010:2019) +
  scale_y_continuous(labels = scales::comma) +
  scale_fill_manual(values = c(palette_color("gold"),
                               palette_color("hybrid"),
                               palette_color("bronze")))

```

PMC appears to overlap most strongly (and overlap has grown most rapidly) with Gold OA, but also a non-negligible amount with Hybrid and Bronze OA. Note, as previously, PMC articles are missing from 2018 and 2019.

### Exclusivity of Green OA

Following the classification procedure of Robinson-Garcia et al. (2019), Green OA is treated as a non-exclusive category, i.e. an article is labelled as Green if it is available via a repository, regardless of its availability status at the journal page. However, some questions remain about this approach in the context of understanding OA impact - for example, from the readership perspective, will readers really use (and be more likely to cite/mention) an article if it is an OA repository, when it is also available directly on a journal page? And from the authors perspective - do the authors who publish in OA journals **and** self-archive their papers represent a different demographic/category of authors, than those who **only** self-archive? The impact dynamics are therefore likely different for Green OA, depending on the availability of the corresponding journal article.

##### Number of Green OA articles that are open and closed at the corresponding journal page ([query](queries/calc_unpaywall_classification_green_types.sql))

```{r echo = F, message = F, warning = F}

read_csv("data/unpaywall_classification_green_types.csv") %>%
  pivot_longer(all_green:only_green) %>%
  filter(name %in% c("journal_oa_green", "only_green")) %>%
  mutate(name = factor(name,
                       levels = c("only_green",
                                  "journal_oa_green"),
                       labels = c("Closed at journal page",
                                  "Open at journal page"))) %>%
  ggplot() +
  geom_bar(aes(x = year, y = value, fill = name), 
           stat = "identity", position = "dodge", width = 0.75) +
  labs(x = "", 
       y = "Articles",
       title = "Green OA by journal article availability",
       fill = "Article availability") +
  scale_x_continuous(breaks = 2010:2019) +
  scale_y_continuous(labels = scales::comma) +
  scale_fill_manual(values = c(palette_color("light green"),
                               palette_color("dark green")))

```

It appears that Green OA growth is more strongly represented by articles which are also available at the corresponding journal page, than closed articles. Note, however, that the above figures includes PMC articles - as shown in the previous section, there is also a large overlap of PMC with Gold OA, and to a lesser extent with Hybrid and Bronze OA.

##### Number of Green OA articles published in different types of OA journals ([query](queries/calc_unpaywall_classification_green_types.sql))

```{r echo = F, message = F, warning = F}

read_csv("data/unpaywall_classification_green_types.csv") %>%
  pivot_longer(all_green:only_green) %>%
  filter(name %in% c("gold_green", "hybrid_green", "bronze_green")) %>%
  mutate(name = factor(name,
                       levels = c("gold_green",
                                  "hybrid_green",
                                  "bronze_green"),
                       labels = c("Gold",
                                  "Hybrid",
                                  "Bronze"))) %>%
  ggplot() +
  geom_bar(aes(x = year, y = value, fill = name),
           stat = "identity", position = "dodge", width = 0.75) +
  labs(x = "", 
       y = "Articles",
       title = "Green OA by journal type",
       fill = "OA Type") +
  scale_x_continuous(breaks = 2010:2019) +
  scale_y_continuous(labels = scales::comma) +
  scale_fill_manual(values = c(palette_color("gold"),
                               palette_color("hybrid"),
                               palette_color("bronze")))

```

The results show that the contribution of Gold articles to Green OA shares has grown most strongly between 2010 and 2017. However, approximately 75% of the growth can be attributed to growth in deposits to PMC. Interestingly, whilst the contribution of Hybrid OA has grown over this time period, the contribution of Bronze OA remains relatively static, and even falls marginally from 2014 onwards. 

### Recommendations for classifying Green OA in this study

From the above results, a general recommendation is that Green OA should not be considered a 'black box' in the context of understanding impact metrics, as it includes multiple archiving routes, and interacts strongly with other forms of OA. However, creating many other 'categories' of Green OA (i.e. one category for Green OA including PMC and one excluding PMC) for analysis purposes is also sub-optimal, as categories become increasingly granular and large-scale mechanisms influencing impact are lost.

For simplification purposes, PMC is therefore excluded as a form of Green OA in the following study. The reasoning for this is based on: (1) that PMC clearly represents a different *form* of archiving than other forms of Green OA, i.e. the author takes no direct action to deposit their work, (2) that PMC largely overlaps with other forms of journal-based OA, in particular with Gold OA, which may skew results towards these OA forms, and (3) there exist data quality issues, with respect to missing PMC data in 2018 and 2019.

## Altmetric Coverage and OA

### By Year

##### Total altmetric coverage per indicator ([query](queries/calc_altmetrics_coverage_year.sql))

```{r echo = F, message = F, warning = F, fig.height = 3, fig.width = 12}

read_csv("data/altmetrics_coverage_year.csv") %>%
  pivot_longer(blogs:wikipedia,
               names_to = "indicator",
               values_to = "items_covered") %>%
  mutate(coverage = items_covered / items) %>%
  ggplot() +
  geom_bar(aes(x = year, y = coverage), 
           stat = "identity") +
  facet_wrap(. ~ indicator, nrow = 1) +
  scale_y_continuous(labels = scales::percent) +
  scale_x_continuous(breaks = c(2012, 2014, 2016, 2018)) +
  labs(x = "",
       y = "Coverage (%)")

```

The highest coverage is observed in Twitter, followed by Facebook, then news and blogs, Wikipedia and policies. Different temporal trends are observed for each indicator, e.g. Twitter coverage increases between 2012 and 2016, which may reflect rapid user growth on the platform itself. Conversely, policy citations decrease over time, likely because policy citations take longer to accrue (~years) than mentions on social media (~days to weeks) (see [Fang and Costas, 2018](https://openaccess.leidenuniv.nl/handle/1887/65278)).

##### Relative altmetric coverage in OA versus non-OA publications ([query](queries/calc_altmetrics_coverage_year_oa.sql))

```{r echo = F, message = F, warning = F, fig.height = 3, fig.width = 12}

read_csv("data/altmetrics_coverage_year_oa.csv") %>%
  pivot_longer(blogs:wikipedia,
               names_to = "indicator",
               values_to = "items_covered") %>%
  mutate(type = factor(type, levels = c("open", "closed")),
         coverage = items_covered / items) %>%
  group_by(year, indicator) %>%
  mutate(rel_coverage = coverage / (sum(items_covered) / sum(items))) %>%
  ggplot() +
  geom_point(aes(x = year, y = rel_coverage, fill = type), 
             shape = 21, color = "grey10", size = 3, alpha = 0.75) +
  geom_hline(yintercept = 1, linetype = "dotted") +
  facet_wrap(~ indicator, nrow = 1) +
  scale_y_continuous(limits = c(0,2)) +
  scale_x_continuous(breaks = c(2012, 2014, 2016, 2018)) +
  scale_fill_manual(values = c(palette_color("open"), 
                               palette_color("closed"))) +
  labs(x = "",
       y = "Relative Coverage",
       fill = "")

```
In general terms, OA articles receive greater coverage in all altmetric indicators than non-OA articles. The advantage is surprisingly stable across altmetric indicators, with values of relative coverage between 1.25-1.75 for OA articles (i.e. OA articles receive 25-75 % more coverage than the baseline coverage of all articles). For some indicators, e.g. Facebook, news articles, Twitter and Wikipedia, the OA advantage appears to weaken over time, whilst for blogs the advantage remains relatively stable, and even increases marginally for policies.

##### Relative altmetric coverage in different access types ([query](queries/calc_altmetrics_coverage_year_oa_types.sql))

```{r echo = F, message = F, warning = F, fig.height = 3, fig.width = 12}

read_csv("data/altmetrics_coverage_year_oa_types.csv") %>%
  pivot_longer(blogs:wikipedia,
               names_to = "indicator",
               values_to = "items_covered") %>%
  mutate(type = factor(type, 
                levels = c("closed", "gold", "hybrid", "bronze", "green")),
         coverage = items_covered / items) %>%
  group_by(year, indicator) %>%
  mutate(rel_coverage = coverage / (sum(items_covered) / sum(items))) %>%
  ggplot() +
  geom_point(aes(x = year, y = rel_coverage, fill = type), 
             shape = 21, color = "grey10", size = 3, alpha = 0.75) +
  geom_hline(yintercept = 1, linetype = "dotted") +
  facet_wrap(~ indicator, nrow = 1) +
  scale_y_continuous(limits = c(0,2)) +
  scale_x_continuous(breaks = c(2012, 2014, 2016, 2018)) +
  scale_fill_manual(values = c(palette_color("closed"), 
                               palette_color("gold"),
                               palette_color("hybrid"),
                               palette_color("bronze"),
                               palette_color("green"))) +
  labs(x = "",
       y = "Relative Coverage",
       fill = "")

```

### By Classification

```{r echo = F, message = F, warning = F}

# A helper function to reclassify Leiden Ranking fields to abbreviated titles
abbreviate_classifications <- function(d) {
  d %>%
    mutate(classification = factor(classification,
           levels = c("Biomedical and health sciences",
                      "Life and earth sciences",
                      "Mathematics and computer science",
                      "Physical sciences and engineering",
                      "Social sciences and humanities"),
           labels = c("BHS", "LES", "MCS", "PSE", "SSH")))
}

```

##### Total altmetric coverage per indicator ([query](queries/calc_altmetrics_coverage_classification.sql))

```{r echo = F, message = F, warning = F, fig.height = 3, fig.width = 12}

read_csv("data/altmetrics_coverage_classification.csv") %>%
  abbreviate_classifications() %>%
  pivot_longer(blogs:wikipedia,
               names_to = "indicator",
               values_to = "items_covered") %>%
  mutate(coverage = items_covered / items) %>%
  ggplot() +
  geom_bar(aes(x = classification, y = coverage), 
           stat = "identity") +
  facet_wrap(. ~ indicator, nrow = 1) +
  scale_y_continuous(labels = scales::percent) +
  labs(x = "",
       y = "Coverage (%)")

```

##### Relative altmetric coverage in OA versus non-OA publications ([query](queries/calc_altmetrics_coverage_classification_oa.sql))

```{r echo = F, message = F, warning = F, fig.height = 3, fig.width = 12}

read_csv("data/altmetrics_coverage_classification_oa.csv") %>%
  abbreviate_classifications() %>%
  pivot_longer(blogs:wikipedia,
               names_to = "indicator",
               values_to = "items_covered") %>%
  mutate(type = factor(type, levels = c("open", "closed")),
         coverage = items_covered / items) %>%
  group_by(classification, indicator) %>%
  mutate(rel_coverage = coverage / (sum(items_covered) / sum(items))) %>%
  ggplot() +
  geom_point(aes(x = classification, y = rel_coverage, fill = type), 
             shape = 21, color = "grey10", size = 3, alpha = 0.75) +
  geom_hline(yintercept = 1, linetype = "dotted") +
  facet_wrap(~ indicator, nrow = 1) +
  scale_y_continuous(limits = c(0,2.5)) +
  scale_fill_manual(values = c(palette_color("open"), 
                               palette_color("closed"))) +
  labs(x = "",
       y = "Relative Coverage",
       fill = "")

```

##### Relative altmetric coverage in different access types ([query](queries/calc_altmetrics_coverage_classification_oa_types.sql))

```{r echo = F, message = F, warning = F, fig.height = 3, fig.width = 12}

read_csv("data/altmetrics_coverage_classification_oa_types.csv") %>%
  abbreviate_classifications() %>%
  pivot_longer(blogs:wikipedia,
               names_to = "indicator",
               values_to = "items_covered") %>%
  mutate(type = factor(type, 
                levels = c("closed", "gold", "hybrid", "bronze", "green")),
         coverage = items_covered / items) %>%
  group_by(classification, indicator) %>%
  mutate(rel_coverage = coverage / (sum(items_covered) / sum(items))) %>%
  ggplot() +
  geom_point(aes(x = classification, y = rel_coverage, fill = type), 
             shape = 21, color = "grey10", size = 3, alpha = 0.75) +
  geom_hline(yintercept = 1, linetype = "dotted") +
  facet_wrap(~ indicator, nrow = 1) +
  scale_y_continuous(limits = c(0,3.5)) +
  scale_fill_manual(values = c(palette_color("closed"), 
                               palette_color("gold"),
                               palette_color("hybrid"),
                               palette_color("bronze"),
                               palette_color("green"))) +
  labs(x = "",
       y = "Relative Coverage",
       fill = "")

```

### By Country

##### Total altmetric coverage per indicator ([query](queries/calc_altmetrics_coverage_country.sql))

```{r echo = F, message = F, warning = F, fig.height = 12, fig.width = 12}

read_csv("data/altmetrics_coverage_country.csv") %>%
  arrange(desc(items)) %>%
  top_n(50) %>%
  pivot_longer(blogs:wikipedia,
               names_to = "indicator",
               values_to = "items_covered") %>%
  mutate(coverage = items_covered / items,
         region = countrycode::countrycode(country, 
                                           origin = "iso2c",
                                           destination = "continent"),
         country = countrycode::countrycode(country,
                                            origin = "iso2c",
                                            destination = "country.name")) %>%
  ggplot(aes(x = reorder(country, desc(country)), y = coverage, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_grid(region ~ indicator, scales = "free_y", space = "free") +
  scale_y_continuous(labels = scales::percent) +
  labs(x = "",
       y = "Coverage (%)",
       fill = "") +
  coord_flip() +
  theme(strip.text.y = element_blank())

```

##### Relative altmetric coverage in OA versus non-OA publications ([query](queries/calc_altmetrics_coverage_country_oa.sql))

```{r echo = F, message = F, warning = F, fig.height = 12, fig.width = 12}

top_countries <- read_csv("data/altmetrics_coverage_country.csv") %>%
  arrange(desc(items)) %>%
  top_n(50) %>%
  pull(country)

read_csv("data/altmetrics_coverage_country_oa.csv") %>%
  filter(country %in% top_countries) %>%
  pivot_longer(blogs:wikipedia,
               names_to = "indicator",
               values_to = "items_covered") %>%
  mutate(type = factor(type, levels = c("open", "closed")),
         coverage = items_covered / items,
         region = countrycode::countrycode(country, 
                                           origin = "iso2c",
                                           destination = "continent"),
         country = countrycode::countrycode(country,
                                            origin = "iso2c",
                                            destination = "country.name")) %>%
  group_by(country, indicator) %>%
  mutate(rel_coverage = coverage / (sum(items_covered) / sum(items))) %>%
  ggplot() +
  geom_point(aes(x = reorder(country, desc(country)), 
                 y = rel_coverage, 
                 fill = type), 
             shape = 21, color = "grey10", size = 3, alpha = 0.75) +
  geom_hline(yintercept = 1, linetype = "dotted") +
  facet_grid(region ~ indicator, scales = "free_y", space = "free") +
  scale_y_continuous(limits = c(0,4.5)) +
  scale_fill_manual(values = c(palette_color("open"), 
                               palette_color("closed"))) +
  labs(x = "",
       y = "Relative Coverage",
       fill = "") +
  coord_flip() +
  theme(strip.text.y = element_blank())

```

